<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>BrowsePlugin.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sxr -- Scala X-Ray
 * Copyright 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> sxr

<span class="keyword">import</span> scala.tools.nsc.<span class="delimiter">{</span>plugins, Global, Phase<span class="delimiter">}</span>
<span class="keyword">import</span> plugins.PluginComponent
<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.URL

<span class="keyword">import</span> <a href="OutputFormat.scala.html#9534" title="object sxr.OutputFormat">OutputFormat</a>.<span class="delimiter">{</span>OutputFormat, Html<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object sxr.BrowsePlugin" id="9489">BrowsePlugin</a>
<span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="48808">PluginName</a> = <span title="java.lang.String(&quot;sxr&quot;)" class="string">&quot;sxr&quot;</span>
  <span class="comment">/** This is the name of the option that specifies the base directories against which sources should be relativized.*/</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="48810">BaseDirectoryOptionName</a> = <span title="java.lang.String(&quot;base-directory:&quot;)" class="string">&quot;base-directory:&quot;</span>
  <span class="comment">/** This is the name of the option that specifies the desired output formats.*/</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="48812">OutputFormatsOptionName</a> = <span title="java.lang.String(&quot;output-formats:&quot;)" class="string">&quot;output-formats:&quot;</span>
  <span class="comment">/** The separator in the list of output formats.*/</span>
  <span class="keyword">val</span> <a title="Char" id="48814">OutputFormatSeparator</a> = <span title="Char(\'+\')" class="char">'+'</span>
  <span class="comment">/** This is the name of the options that specifies a file containing one URL per line for each external sxr location to link to. */</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="48816">ExternalLinksOptionName</a> = <span title="java.lang.String(&quot;link-file:&quot;)" class="string">&quot;link-file:&quot;</span>
<span class="delimiter">}</span>
<span class="comment">/* The standard plugin setup.  The main implementation is in Browse.  The entry point is Browse.generateOutput */</span>
<span class="keyword">class</span> <a title="class BrowsePlugin extends sxr.Browse with ScalaObject" id="9491">BrowsePlugin</a><a href="#9491" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="48857">global</a>: <span title="scala.tools.nsc.Global">Global</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="Browse.scala.html#9474" title="sxr.Browse">Browse</a>
<span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#48857" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="#9489" title="object sxr.BrowsePlugin">BrowsePlugin</a>._
  
  <span class="keyword">val</span> <a title="java.lang.String" id="48824">name</a> = <a href="#48808" title="=&gt; java.lang.String">PluginName</a>
  <span class="keyword">val</span> <a title="java.lang.String" id="48826">description</a> = <span title="java.lang.String(&quot;A plugin to produce a browsable representation of the input sources.&quot;)" class="string">&quot;A plugin to produce a browsable representation of the input sources.&quot;</span>
  <span class="keyword">val</span> <a title="List[scala.tools.nsc.plugins.PluginComponent]" id="48828">components</a> = <span title="[A](xs: A*)List[A]">List</span><span title="(xs: scala.tools.nsc.plugins.PluginComponent*)List[scala.tools.nsc.plugins.PluginComponent]" class="delimiter">[</span><span title="scala.tools.nsc.plugins.PluginComponent">PluginComponent</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#48849" title="object BrowsePlugin.this.Component">Component</a><span class="delimiter">)</span>
  
  <span class="comment">/** The directory against which the input source paths will be relativized.*/</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[java.io.File]" id="48831">baseDirectories</a>: <span title="List[java.io.File]">List</span><span class="delimiter">[</span>File<span class="delimiter">]</span> = <span title="object Nil">Nil</span>
  <span class="keyword">var</span> <a title="List[java.net.URL]" id="48834">externalLinkURLs</a>: <span title="List[java.net.URL]">List</span><span class="delimiter">[</span>URL<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.io.File" id="48837">classDirectory</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#48857" title="=&gt; scala.tools.nsc.Settings">settings</a>.<span title="=&gt; scala.tools.nsc.Settings#OutputSetting">outdir</span>.<span title="=&gt; java.lang.String">value</span><span class="delimiter">)</span>

  <span class="comment">/** The output formats to write */</span>
  <span class="keyword">var</span> <a title="List[sxr.OutputFormat.OutputFormat]" id="48839">outputFormats</a>: <span title="List[sxr.OutputFormat.OutputFormat]">List</span><span class="delimiter">[</span>OutputFormat<span class="delimiter">]</span> = <span title="(xs: sxr.OutputFormat.Value*)List[sxr.OutputFormat.Value]">List</span><span class="delimiter">(</span><a href="OutputFormat.scala.html#26728" title="=&gt; sxr.OutputFormat.Value">Html</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(options: List[String], error: String =&gt; Unit)Unit" id="48841">processOptions</a><span class="delimiter">(</span><a title="List[String]" id="48922">options</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="String =&gt; Unit" id="48923">error</a>: String =&gt; Unit<span class="delimiter">)</span>
  <span class="delimiter">{</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="String" id="48944">option</a> &lt;- <a href="#48922" title="(f: String =&gt; Unit)Unit">options</a><span class="delimiter">)</span>
    <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#48810" title="=&gt; java.lang.String">BaseDirectoryOptionName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#48831" title="(x$1: List[java.io.File])Unit">baseDirectories</a> = <a href="#48842" title="(str: String)List[java.io.File]">parseBaseDirectories</a><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#48810" title="=&gt; java.lang.String">BaseDirectoryOptionName</a>.<span title="()Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#48812" title="=&gt; java.lang.String">OutputFormatsOptionName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#48839" title="(x$1: List[sxr.OutputFormat.OutputFormat])Unit">outputFormats</a> = <a href="#48843" title="(str: String)List[sxr.OutputFormat.OutputFormat]">parseOutputFormats</a><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#48812" title="=&gt; java.lang.String">OutputFormatsOptionName</a>.<span title="()Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#48816" title="=&gt; java.lang.String">ExternalLinksOptionName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#48834" title="(x$1: List[java.net.URL])Unit">externalLinkURLs</a> = <a href="#48844" title="(links: String)List[java.net.URL]">parseExternalLinks</a><span class="delimiter">(</span><a href="#48944" title="String">option</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#48816" title="=&gt; java.lang.String">ExternalLinksOptionName</a>.<span title="()Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#48923" title="(v1: String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Option for source browser plugin not understood: &quot;)" class="string">&quot;Option for source browser plugin not understood: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48944" title="String">option</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(str: String)List[java.io.File]" id="48842">parseBaseDirectories</a><span class="delimiter">(</span><a title="String" id="48947">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="List[java.io.File]">List</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
    <a href="#48947" title="String">str</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="object java.io.File">File</span>.<span title="java.lang.String">pathSeparator</span><span class="delimiter">)</span>.<span title="(f: java.lang.String =&gt; java.io.File)(implicit bf: scala.collection.generic.CanBuildFrom[Array[java.lang.String],java.io.File,Array[java.io.File]])Array[java.io.File]">map</span><span title="(xs: Array[java.io.File])scala.collection.mutable.ArrayOps[java.io.File]" class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#49420" title="java.lang.String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[java.io.File]">toList</span>

  <span class="keyword">def</span> <a title="(str: String)List[sxr.OutputFormat.OutputFormat]" id="48843">parseOutputFormats</a><span class="delimiter">(</span><a title="String" id="48953">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="List[sxr.OutputFormat.OutputFormat]">List</span><span class="delimiter">[</span>OutputFormat<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(s: String)Option[sxr.OutputFormat.OutputFormat]" id="49606">valueOf</a><span class="delimiter">(</span><a title="String" id="49607">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Option[sxr.OutputFormat.OutputFormat]">Option</span><span class="delimiter">[</span>OutputFormat<span class="delimiter">]</span> = <a href="OutputFormat.scala.html#9534" title="object sxr.OutputFormat">OutputFormat</a>.<a href="OutputFormat.scala.html#26732" title="=&gt; List[sxr.OutputFormat.OutputFormat]">all</a>.<span title="(p: sxr.OutputFormat.OutputFormat =&gt; Boolean)Option[sxr.OutputFormat.OutputFormat]">find</span><span class="delimiter">(</span><a href="#49618" title="sxr.OutputFormat.OutputFormat">_</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#49607" title="String">s</a><span class="delimiter">)</span>
      .<span title="(alternative: =&gt; Option[sxr.OutputFormat.OutputFormat])Option[sxr.OutputFormat.OutputFormat]">orElse</span> <span class="delimiter">{</span> <a href="#48857" title="(msg: String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Invalid sxr output format: &quot;)" class="string">&quot;Invalid sxr output format: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#49607" title="String">s</a><span class="delimiter">)</span> ; <span title="object None">None</span> <span class="delimiter">}</span>
    <a href="#48953" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">str</a>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><a href="#48814" title="=&gt; Char">OutputFormatSeparator</a><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[sxr.OutputFormat.OutputFormat])(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],sxr.OutputFormat.OutputFormat,Array[sxr.OutputFormat.OutputFormat]])Array[sxr.OutputFormat.OutputFormat]">flatMap</span><span title="(xs: Array[sxr.OutputFormat.OutputFormat])scala.collection.mutable.ArrayOps[sxr.OutputFormat.OutputFormat]" class="delimiter">(</span><a href="#49606" title="(xo: Option[sxr.OutputFormat.OutputFormat])Iterable[sxr.OutputFormat.OutputFormat]">valueOf</a><span class="delimiter">)</span>.<span title="=&gt; List[sxr.OutputFormat.OutputFormat]">toList</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(links: String)List[java.net.URL]" id="48844">parseExternalLinks</a><span class="delimiter">(</span><a title="String" id="48959">links</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="List[java.net.URL]">List</span><span class="delimiter">[</span>URL<span class="delimiter">]</span> =
  <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.File" id="50278">f</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#48959" title="String">links</a><span class="delimiter">)</span>
    <span title="List[java.net.URL]" class="keyword">if</span><span class="delimiter">(</span><a href="#50278" title="java.io.File">f</a>.<span title="()Boolean">exists</span><span class="delimiter">)</span> <a href="#48845" title="(f: java.io.File)List[java.net.URL]">readExternalLinks</a><span class="delimiter">(</span><a href="#50278" title="java.io.File">f</a><span class="delimiter">)</span> <span class="keyword">else</span> <span class="delimiter">{</span> <a href="#48857" title="(msg: String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Link file does not exist: &quot;)" class="string">&quot;Link file does not exist: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#50278" title="java.io.File">f</a>.<span title="()java.lang.String">getAbsolutePath</span><span class="delimiter">)</span>; <span title="object Nil">Nil</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(f: java.io.File)List[java.net.URL]" id="48845">readExternalLinks</a><span class="delimiter">(</span><a title="java.io.File" id="50283">f</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="List[java.net.URL]">List</span><span class="delimiter">[</span>URL<span class="delimiter">]</span> =
    <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11954" title="(file: java.io.File, encoding: String, value: List[java.net.URL])(f: (List[java.net.URL], String) =&gt; List[java.net.URL])List[java.net.URL]">readLines</a><span class="delimiter">(</span><a href="#50283" title="java.io.File">f</a>, <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11942" title="=&gt; java.lang.String">DefaultEncoding</a>, <a href="#48834" title="=&gt; List[java.net.URL]">externalLinkURLs</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span> <a title="List[java.net.URL]" id="50329">links</a>, <a title="String" id="50330">line</a><span class="delimiter">)</span> =&gt;
      <a href="#48846" title="(line: String)Option[java.net.URL]">parseURL</a><span class="delimiter">(</span><a href="#50330" title="String">line</a>.<span title="()java.lang.String">trim</span><span class="delimiter">)</span>.<span title="=&gt; List[java.net.URL]">toList</span> <a href="#50331" title="(prefix: List[java.net.URL])List[java.net.URL]">:::</a> <a href="#50329" title="List[java.net.URL]">links</a>
    <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(line: String)Option[java.net.URL]" id="48846">parseURL</a><span class="delimiter">(</span><a title="String" id="50332">line</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Option[java.net.URL]">Option</span><span class="delimiter">[</span>URL<span class="delimiter">]</span> =
    <span title="Option[java.net.URL]" class="keyword">if</span><span class="delimiter">(</span><a href="#50332" title="String">line</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#50332" title="String">line</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;#&quot;)" class="string">&quot;#&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="object None">None</span> <span class="keyword">else</span> <span title="(x: java.net.URL)Some[java.net.URL]">Some</span><span class="delimiter">(</span><span title="(x$1: java.lang.String)java.net.URL" class="keyword">new</span> <span title="java.net.URL">URL</span><span class="delimiter">(</span><a href="#50332" title="String">line</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">val</span> <a title="Option[String]" id="48847">optionsHelp</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> =
  <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="50408">prefix</a> = <span title="java.lang.String(&quot;  -P:&quot;)" class="string">&quot;  -P:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48824" title="=&gt; java.lang.String">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="50409">base</a> = <a href="#50408" title="java.lang.String">prefix</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48810" title="=&gt; java.lang.String">BaseDirectoryOptionName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;&lt;paths&gt;            Set the base source directories.&quot;)" class="string">&quot;&lt;paths&gt;            Set the base source directories.&quot;</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="50410">formats</a> = <a href="#50408" title="java.lang.String">prefix</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48812" title="=&gt; java.lang.String">OutputFormatsOptionName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;&lt;formats&gt;          \'&quot;)" class="string">&quot;&lt;formats&gt;          '&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48814" title="=&gt; Char">OutputFormatSeparator</a> <span title="(x$1: Any)java.lang.String">+</span>
      <span title="java.lang.String(&quot;\'-separated list of output formats to write (available: &quot;)" class="string">&quot;'-separated list of output formats to write (available: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="OutputFormat.scala.html#9534" title="object sxr.OutputFormat">OutputFormat</a>.<a href="OutputFormat.scala.html#26732" title="=&gt; List[sxr.OutputFormat.OutputFormat]">all</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; - defaults to: &quot;)" class="string">&quot; - defaults to: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="OutputFormat.scala.html#26728" title="=&gt; sxr.OutputFormat.Value">Html</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;).&quot;)" class="string">&quot;).&quot;</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="50411">link</a> = <a href="#50408" title="java.lang.String">prefix</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#48816" title="=&gt; java.lang.String">ExternalLinksOptionName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;&lt;path&gt;            Set the file containing sxr link.index URLs for external linking.&quot;)" class="string">&quot;&lt;path&gt;            Set the file containing sxr link.index URLs for external linking.&quot;</span>

    <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span> <span title="(elems: java.lang.String*)Seq[java.lang.String]">Seq</span><span class="delimiter">(</span><a href="#50409" title="java.lang.String">base</a>, <a href="#50410" title="java.lang.String">formats</a>, <a href="#50411" title="java.lang.String">link</a><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span> <span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">object</span> <a title="object BrowsePlugin.this.Component" id="48849">Component</a> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.tools.nsc.plugins.PluginComponent">PluginComponent</span>
  <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="48872">global</a> = <a href="#9491" title="BrowsePlugin.this.type">BrowsePlugin</a>.<span class="keyword">this</span>.<a href="#48857" title="=&gt; scala.tools.nsc.Global">global</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="48874">phaseName</a> = <a href="#9491" title="BrowsePlugin.this.type">BrowsePlugin</a>.<span class="keyword">this</span>.<a href="#48824" title="=&gt; java.lang.String">name</a>
    <span class="keyword">def</span> <a title="(prev: scala.tools.nsc.Phase)BrowsePlugin.this.BrowsePhase" id="48876">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="50451">prev</a>: <span title="scala.tools.nsc.Phase">Phase</span><span class="delimiter">)</span> = <span title="BrowsePlugin.this.BrowsePhase" class="keyword">new</span> <a href="#48851" title="BrowsePlugin.this.BrowsePhase">BrowsePhase</a><span class="delimiter">(</span><a href="#50451" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="List[java.lang.String]" id="48877">runsAfter</a> = <span title="java.lang.String(&quot;typer&quot;)" class="string">&quot;typer&quot;</span> <a href="#50443" title="(x: java.lang.String)List[java.lang.String]">::</a> <span title="object Nil">Nil</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="List[java.lang.String]" id="48879">runsBefore</a> = <span title="java.lang.String(&quot;superaccessors&quot;)" class="string">&quot;superaccessors&quot;</span> <a href="#50447" title="(x: java.lang.String)List[java.lang.String]">::</a> <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class BrowsePhase extends scala.tools.nsc.Phase with ScalaObject" id="48851">BrowsePhase</a><a href="#48851" title="ScalaObject" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="50552">prev</a>: <span title="scala.tools.nsc.Phase">Phase</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.tools.nsc.Phase">Phase</span><span class="delimiter">(</span><a href="#50552" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span>
  <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="50550">name</a> = <a href="#9491" title="BrowsePlugin.this.type">BrowsePlugin</a>.<span class="keyword">this</span>.<a href="#48824" title="=&gt; java.lang.String">name</a>
    <span class="keyword">def</span> <a title="()Unit" id="50551">run</a> = <a href="Browse.scala.html#26784" title="(externalLinks: List[sxr.LinkMap])Unit">generateOutput</a><span class="delimiter">(</span><a href="#48852" title="=&gt; List[sxr.LinkMap]">externalLinkMaps</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[sxr.LinkMap]" id="48852">externalLinkMaps</a>: <span title="List[sxr.LinkMap]">List</span><span class="delimiter">[</span>LinkMap<span class="delimiter">]</span> = <a href="#48834" title="=&gt; List[java.net.URL]">externalLinkURLs</a>.<span title="(f: java.net.URL =&gt; sxr.LinkMap)(implicit bf: scala.collection.generic.CanBuildFrom[List[java.net.URL],sxr.LinkMap,List[sxr.LinkMap]])List[sxr.LinkMap]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,sxr.LinkMap,List[sxr.LinkMap]]" class="delimiter">(</span><a href="#48853" title="(link: java.net.URL)sxr.LinkMap">getLinkMap</a><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(link: java.net.URL)sxr.LinkMap" id="48853">getLinkMap</a><span class="delimiter">(</span><a title="java.net.URL" id="50597">link</a>: <span title="java.net.URL">URL</span><span class="delimiter">)</span> =
  <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.net.URL" id="50600">index</a> = <span title="(x$1: java.net.URL, x$2: java.lang.String)java.net.URL" class="keyword">new</span> <span title="java.net.URL">URL</span><span class="delimiter">(</span><a href="#50597" title="java.net.URL">link</a>, <a href="Browse.scala.html#9472" title="object sxr.Browse">Browse</a>.<a href="Browse.scala.html#26737" title="=&gt; java.lang.String">LinkIndexRelativePath</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.io.File" id="50601">cached</a> = <a href="#48854" title="(link: java.net.URL)java.io.File">cachedLinkFile</a><span class="delimiter">(</span><a href="#50600" title="java.net.URL">index</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#50601" title="java.io.File">cached</a>.<span title="()Boolean">exists</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11963" title="(url: java.net.URL, file: java.io.File)Unit">downloadCompressed</a><span class="delimiter">(</span><span title="(x$1: java.net.URL, x$2: java.lang.String)java.net.URL" class="keyword">new</span> <span title="java.net.URL">URL</span><span class="delimiter">(</span><a href="#50597" title="java.net.URL">link</a>, <a href="Browse.scala.html#9472" title="object sxr.Browse">Browse</a>.<a href="Browse.scala.html#26739" title="=&gt; java.lang.String">CompressedLinkIndexRelativePath</a><span class="delimiter">)</span>, <a href="#50601" title="java.io.File">cached</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Unit" id="50613">e</a>: java.io.<span title="java.io.IOException">IOException</span> =&gt; <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11962" title="(url: java.net.URL, file: java.io.File)Unit">download</a><span class="delimiter">(</span><a href="#50600" title="java.net.URL">index</a>, <a href="#50601" title="java.io.File">cached</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="LinkMap.scala.html#9527" title="object sxr.LinkMapStore">LinkMapStore</a>.<a href="LinkMap.scala.html#50650" title="(file: java.io.File, base: Option[java.net.URL])sxr.LinkMap">read</a><span class="delimiter">(</span><a href="#50601" title="java.io.File">cached</a>, <span title="(x: java.net.URL)Some[java.net.URL]">Some</span><span class="delimiter">(</span><a href="#50597" title="java.net.URL">link</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(link: java.net.URL)java.io.File" id="48854">cachedLinkFile</a><span class="delimiter">(</span><a title="java.net.URL" id="50606">link</a>: <span title="java.net.URL">URL</span><span class="delimiter">)</span>: <span title="java.io.File">File</span> =
  <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.File" id="50686">cacheDirectory</a> = <span title="(x$1: java.io.File, x$2: java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span> <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#48857" title="=&gt; scala.tools.nsc.Settings">settings</a>.<span title="=&gt; scala.tools.nsc.Settings#OutputSetting">outdir</span>.<span title="=&gt; java.lang.String">value</span><span class="delimiter">)</span>.<span title="()java.io.File">getAbsoluteFile</span>.<span title="()java.io.File">getParentFile</span>, <a href="Browse.scala.html#9472" title="object sxr.Browse">Browse</a>.<a href="Browse.scala.html#26741" title="=&gt; java.lang.String">CacheRelativePath</a><span class="delimiter">)</span>
    <span title="(x$1: java.io.File, x$2: java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#50686" title="java.io.File">cacheDirectory</a>, <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11965" title="(s: String)String">hash</a><span class="delimiter">(</span><a href="#50606" title="java.net.URL">link</a>.<span title="()java.lang.String">toExternalForm</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Relativizes the path to the given Scala source file against the base directories. */</span>
  <span class="keyword">def</span> <a title="(source: java.io.File)String" id="48855">getRelativeSourcePath</a><span class="delimiter">(</span><a title="java.io.File" id="50702">source</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#48831" title="=&gt; List[java.io.File]">baseDirectories</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[java.io.File],String,List[String]])List[String]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a title="java.io.File" id="50729">base</a> =&gt; <a href="FileUtil.scala.html#9509" title="object sxr.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#11952" title="(baseFile: java.io.File, file: java.io.File)Option[String]">relativize</a><span title="(xo: Option[String])Iterable[String]" class="delimiter">(</span><a href="#50729" title="java.io.File">base</a>, <a href="#50702" title="java.io.File">source</a><span class="delimiter">)</span> <span class="delimiter">}</span> <span title="String" class="keyword">match</span>
    <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String">Nil</span> =&gt; <a href="#50702" title="java.io.File">source</a>.<span title="()java.lang.String">getName</span>
      <span class="keyword">case</span> <a title="String" id="50801">x</a> :: <span title="object Nil">Nil</span> =&gt; <a href="#50801" title="String">x</a>
      <span class="keyword">case</span> <a title="String" id="50802">xs</a> =&gt; <a href="#50802" title="List[String]">xs</a> <span title="(f: (String, String) =&gt; String)String">reduceLeft</span> <a href="#48856" title="(a: String, b: String)String">shortest</a>
    <span class="delimiter">}</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(a: String, b: String)String" id="48856">shortest</a><span class="delimiter">(</span><a title="String" id="50812">a</a>: <span title="String">String</span>, <a title="String" id="50813">b</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#50812" title="String">a</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#50813" title="String">b</a>.<span title="()Int">length</span><span class="delimiter">)</span> <a href="#50812" title="String">a</a> <span class="keyword">else</span> <a href="#50813" title="String">b</a>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>